# Linux IP地址与主机名管理

IP地址和主机名是计算机在网络中的两个核心身份标识。IP地址是其数字坐标，而主机名是方便人类记忆的别名。本笔记介绍如何查看和配置它们。

---

## 一、IP地址管理

IP地址是分配给网络上每个设备的一串数字，用于设备间的通信。==主要用的是v4版本==：a.b.c.d;abcd均是0~255的数字；如192.168.88.101

### 1. 查看IP地址

#### (1) `ip` 命令 (推荐的现代方法)
`ip` 命令是 `iproute2` 工具包的一部分，是现代Linux系统上网络管理的首选工具。

**常用命令**：
```bash
# 显示所有网络接口的详细信息
ip addr show

# 更简洁的别名
ip a
```

**示例输出解析**：
```
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 ...
    link/ether 08:00:27:1a:2b:3c brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.10/24 brd 192.168.1.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::a00:27ff:fe1a:2b3c/64 scope link
       valid_lft forever preferred_lft forever
```
- `eth0`: 网络接口的名称。
- `inet 192.168.1.10/24`: 这是最重要的信息，`192.168.1.10` 是该接口的==IPv4地址==。`/24` 是CIDR表示法，代表子网掩码为 `255.255.255.0`。
- `inet6 ...`: IPv6地址。

#### (2) `ifconfig` 命令 (传统方法)
==`ifconfig`== 是一个较旧的工具，在许多新的Linux发行版中可能需要手动安装 (`net-tools` 包)。yum

**常用命令**：
```bash
ifconfig
```
**示例输出解析**：
```
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.1.10  netmask 255.255.255.0  broadcast 192.168.1.255
        ether 08:00:27:1a:2b:3c  txqueuelen 1000  (Ethernet)
```
- `inet 192.168.1.10`: IPv4地址。
- `netmask 255.255.255.0`: 子网掩码。

---

## 二、主机名管理

主机名（Hostname）是赋予计算机的一个人类可读的名称，用于在网络中方便地识别它（例如 `my-server`）。

### 1. `hostnamectl` 命令 (推荐的现代方法)
在基于 `systemd` 的系统中，`hostnamectl` 是管理主机名的标准工具。

**常用命令**：

- **查看主机名状态**
  ```bash
  hostnamectl
  ```
  **输出示例**：
  ```
     Static hostname: my-server
           Icon name: computer-server
             Chassis: server
          Machine ID: ...
             Boot ID: ...
    Operating System: Ubuntu 22.04 LTS
              Kernel: Linux 5.15.0-48-generic
        Architecture: x86-64
  ```
  `Static hostname` 就是我们通常关心和修改的主机名。

- **设置主机名** (需要 `sudo` 权限)
  ```bash
  sudo hostnamectl set-hostname <新主机名>
  ```
  **示例**：将主机名改为 `web-server-01`。
  ```bash
  sudo hostnamectl set-hostname web-server-01
  ```
  此命令会自动修改 `/etc/hostname` 文件，新主机名通常在重新登录后完全生效。

### 2. `hostname` 命令 (传统方法)
`hostname` 命令也可以用于查看和临时设置主机名。
```bash
# 查看当前主机名
hostname

# 临时设置主机名 (重启后失效)
sudo hostname <新主机名>
```
永久修改主机名（传统方法）需要直接编辑 `/etc/hostname` 文件。

---

## 三、主机名解析与 `/etc/hosts` 文件

当你在终端输入 `ping google.com` 时，系统如何知道 `google.com` 对应的IP地址？这个过程叫做“主机名解析”。

### 1. 解析顺序
系统在解析主机名时，通常会遵循以下顺序：
1.  **查找 `/etc/hosts` 文件**：这是本地的、手动的“DNS”记录。
2.  **查询DNS服务器**：如果 `hosts` 文件中没有找到，系统会去询问配置的DNS服务器（例如 `8.8.8.8`）。

### 2. `/etc/hosts` 文件详解

`/etc/hosts` 文件包含了一系列的IP地址到主机名的映射。

**作用**：
- **本地网络解析**：为局域网内的其他机器指定一个易记的名称。
- **开发测试**：在开发网站时，可以将一个域名（如 `dev.myapp.com`）指向本地 `127.0.0.1`，方便在浏览器中用域名访问本地服务。
- **屏蔽网站**：将某个不希望访问的域名指向 `127.0.0.1`，可以起到屏蔽该网站的效果。

**文件格式**：
每一行代表一个映射，格式为：`<IP地址> <主机名> [别名1] [别名2] ...`

**示例**：
```
# 这是系统默认的，用于本机回环
127.0.0.1   localhost

# 将本机主机名也指向回环地址
127.0.1.1   web-server-01

# --- 自定义条目 ---
# 为局域网内的数据库服务器和文件服务器指定名称
192.168.1.100   db-server.local   db
192.168.1.101   nas-server

# 用于开发，将 myapp.dev 指向本机
127.0.0.1       myapp.dev

# 屏蔽一个广告网站
127.0.0.1       ads.example.com
```

**如何修改**：
使用文本编辑器以 `sudo` 权限打开并编辑。
```bash
sudo vim /etc/hosts
# 或者
sudo nano /etc/hosts
```
修改保存后，效果**立即生效**，无需重启任何服务。
