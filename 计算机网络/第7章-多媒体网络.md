# 第7章 多媒体网络 (Multimedia Networking)

多媒体网络是计算机网络中一个充满挑战和创新的领域。与传统的数据应用（如文件传输、邮件）不同，多媒体应用（如视频、音频）对网络的性能提出了极为苛刻的要求。本章将探讨这些应用的特性，以及网络如何努力满足这些要求。

## 核心内容

### 1. 网络多媒体应用
多媒体应用的核心挑战在于它们对**时延（Delay）**、**抖动（Jitter，即时延的变化）**和**带宽（Bandwidth）**的高度敏感。
*   **应用分类**:
    *   **流式存储的音频/视频**: 如在线视频点播（YouTube, Netflix）。用户可以随时开始、暂停、快进。对时延不那么敏感，可以通过较大的客户端缓存来对抗网络抖动。
    *   **流式实况音频/视频**: 如在线直播、网络电视。实时性要求比点播更高，延迟通常需要在数秒到数十秒之间。
    *   **交互式音频/视频**: 如IP语音（VoIP）、视频会议。这是要求最严格的一类，因为涉及人与人之间的实时互动，端到端时延必须非常低（通常小于150毫秒），否则会严重影响交流体验。

### 2. IP语音 (Voice-over-IP, VoIP)
VoIP是将人的语音数字化，打包成IP分组，并通过互联网进行传输的技术。
*   **挑战**:
    *   **时延敏感**: 为了保证对话的自然流畅，端到端时延是首要考虑因素。
    *   **抖动处理**: 网络中的分组延迟是变化的，VoIP客户端需要一个**播放缓存（playout buffer）**来平滑这种抖动，以固定的速率播放音频。
    *   **丢包补偿**: VoIP通常运行在UDP之上，需要应用层自己处理丢包。常见的方法包括**前向纠错（FEC）**和**交织（Interleaving）**。

### 3. 实时传输协议 (Real-Time Protocol, RTP)
RTP是为实时多媒体数据传输而设计的应用层协议。它通常运行在UDP之上。
*   **功能**: RTP本身**不提供**任何可靠性或QoS保证。它的主要作用是在UDP的基础上，为应用程序提供一些关键的“脚手架”服务：
    *   **载荷类型标识**: 告诉接收方这个分组里装的是哪种类型的编码（如MP3, H.264）。
    *   **序号**: 帮助接收方检测丢包和恢复数据包的原始顺序。
    *   **时间戳**: 帮助接收方计算抖动，并实现同步播放。
*   **RTCP**: 与RTP配合使用的控制协议，用于监控传输质量和反馈统计信息。

### 4. 为多媒体提供服务质量 (QoS) 的网络
标准的互联网提供的是“尽力而为”的服务，无法满足多媒体应用的严格要求。因此，网络研究者设计了一系列机制来提供**服务质量（QoS）**保证。
*   **什么是QoS**: 网络为某个数据流提供的一组可量化的性能承诺，例如保证其带宽不低于2Mbps，延迟不超过100ms。
*   **如何实现QoS**:
    *   **流量整形 (Traffic Shaping)**: 在网络边缘控制数据进入网络的速率，平滑突发流量。常用的算法有**漏桶**和**令牌桶**。
    *   **分组调度 (Packet Scheduling)**: 在路由器中，当多个分组争用同一个输出链路时，决定哪个分组优先发送。
        *   **FIFO**: 先进先出，无差别服务。
        *   **优先权排队**: 实时流量可以“插队”。
        *   **加权公平排队 (WFQ)**: 为不同类型的流量公平地分配链路带宽。
    *   **准入控制 (Admission Control)**: 在建立一个新的数据流之前，先检查网络是否有足够的资源来满足其QoS要求。如果资源不足，则拒绝该数据流的进入，以避免影响现有数据流的服务质量。
*   **QoS体系结构**:
    *   **综合服务 (IntServ)**: 像电路交换一样，为每个数据流预留资源，提供严格的QoS保证。但扩展性差，不适用于大型网络。
    *   **区分服务 (DiffServ)**: 将数据分组划分为几个不同的服务等级（如“金牌”、“银牌”、“铜牌”），并为不同等级的分组提供有差别的、相对的服务。这种方式扩展性好，是目前更主流的QoS实现思路。

本章探讨了在尽力而为（best-effort）的互联网上，如何通过应用层设计（如DASH）和网络层机制（如QoS）来满足多媒体应用苛刻的性能要求，是理解现代流媒体和实时通信技术的关键。
