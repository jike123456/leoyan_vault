# 7.1 网络多媒体应用

多媒体应用已经成为互联网的主导力量，但它们与传统的数据应用（如邮件、文件传输）在性质上有着根本的不同。理解这些不同之处是理解多媒体网络设计的关键。

---

### 1. 多媒体应用分类

根据实时性和交互性的不同，我们可以将网络多媒体应用分为三类：

*   **流式存储的音频/视频 (Streaming Stored Audio/Video)**
    *   **定义**: 媒体内容（如电影、课程视频）预先被存储在服务器上，用户可以按需请求播放。
    *   **特点**:
        *   **可交互**: 用户可以暂停、快进、快退、拖动进度条。
        *   **对时延不敏感**: 用户可以容忍开始播放前有几秒钟的缓冲时间。
    *   **例子**: YouTube, Netflix, 优酷, Bilibili 的点播视频。

*   **流式实况音频/视频 (Streaming Live Audio/Video)**
    *   **定义**: 实时地广播正在发生的事件。
    *   **特点**:
        *   **实时性要求**: 延迟是关键因素，但通常可以容忍几秒到几十秒的延迟。
        *   **交互性有限**: 用户主要是被动接收。
    *   **例子**: 在线体育赛事直播、网络电视、游戏直播。

*   **交互式音频/视频 (Interactive, Real-Time Audio/Video)**
    *   **定义**: 用户之间进行实时的双向或多向音视频交流。
    *   **特点**:
        *   **对时延极度敏感**: 端到端延迟必须非常低（通常要求 < 150ms），否则会严重影响交流的自然性。
        *   **高度交互**: 参与者之间进行实时对话。
    *   **例子**: IP语音 (VoIP, 如微信语音), 视频会议 (如Zoom, 腾讯会议)。

---

### 2. 流式视频的挑战

*   **高带宽需求**: 未经压缩的视频数据量极其巨大。即使经过压缩，高清（HD）和超高清（4K）视频流也需要数Mbps到数十Mbps的持续带宽。
*   **对时延和抖动的敏感性**:
    *   **时延 (Delay)**: 指数据从服务器到客户端所需的时间。
    *   **抖动 (Jitter)**: 指端到端时延的变化。由于网络拥塞状况是动态变化的，每个数据分组的延迟都可能不同。
    *   **影响**: 如果没有机制来补偿抖动，视频播放时就会出现卡顿、画面冻结等现象。客户端通常使用**播放缓存**来平滑抖动，但这会增加初始的播放延迟。

---

### 3. UDP 和 TCP 的选择

为多媒体应用选择合适的运输层协议是一个重要的权衡。

*   **为什么使用 UDP？**
    *   **实时性**: UDP没有TCP的连接建立开销和复杂的拥塞控制机制，可以以最快的速度将数据发送出去。应用程序可以更好地控制发送时机和速率。
    *   **容忍丢包**: 许多多媒体应用可以容忍一定程度的数据丢失。例如，视频中的一帧丢失或音频中的一个短暂噪声，通常不会严重影响整体体验。应用程序可以在应用层设计自己的、更适合实时场景的丢包恢复策略。
    *   **适用**: **流式实况**和**交互式**应用通常优先选择UDP，因为保证低延迟比保证100%的数据可靠性更重要。

*   **为什么使用 TCP？**
    *   **可靠性**: TCP保证所有数据都能按序、无差错地到达。
    *   **防火墙友好**: TCP使用的标准端口（如80, 443）更容易穿透防火墙和NAT设备。
    *   **拥塞控制**: TCP的拥塞控制虽然可能引入延迟，但它能公平地利用可用带宽，并避免压垮网络。
    *   **缺点**: TCP的重传和拥塞控制机制可能导致不可预测的、较大的延迟，这对于实时交互式应用是致命的。
    *   **适用**: **流式存储**应用（如视频点播）通常运行在TCP之上。因为这类应用对启动延迟不那么敏感，可以通过一个较大的客户端缓存来吸收TCP可能带来的延迟抖动，同时又能享受到TCP提供的可靠传输和防火墙穿透能力。现代的**DASH**技术就是基于HTTP/TCP的。
